import{j as e,m as Z,G as ee,r as h,y as B,z as Y,A as z,C as R,D as $,R as se,E as te,H as ae,I as re,J as ne,K as ie,M as le,N as de,O as oe,P as ce,B as U}from"./index-DVmOQZrp.js";import{S as G}from"./Select-BDEop4ZP.js";import{d as J,t as K,s as me}from"./Samples-DUG5vYRn.js";const P=({children:s,className:a,label:c,...d})=>{const t=()=>{const x="w-full block px-2.5 pb-2.5 pt-4 text-sm text-gray-900 bg-transparent border rounded-lg border-1 border-gray-300 shadow-sm appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",g=d.type==="date"?"dark:calendar-icon-white pr-4":"";return e.jsx("input",{...d,className:`${x} ${g} ${a}`,children:s})};return e.jsx(Z.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.2},children:e.jsxs("div",{className:"relative",children:[t(),e.jsx("label",{htmlFor:c,className:"absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-white dark:bg-black px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-200 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1",children:c})]})})},xe=({testInfo:s,handleBasicInfoChange:a,handleDifficultyChange:c,handleTestTypeChange:d})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Basic Information"}),e.jsx(P,{name:"title",label:"Test Title",value:s.title,onChange:a,minLength:10,maxLength:100,required:!0}),e.jsx(P,{name:"description",label:"Test Description",value:s.description,onChange:a,minLength:10,maxLength:200,type:"textarea",required:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(G,{name:"difficulty",label:"Difficulty",options:J,value:s.difficulty,onChange:c,required:!0}),e.jsx(G,{name:"testType",label:"Test Type",options:K,value:s.testType,onChange:d,required:!0})]}),e.jsx(P,{name:"passingScore",type:"number",label:"Passing Score",value:s.passingScore||0,onChange:a,required:!0}),e.jsx(P,{name:"availableFrom",type:"date",label:"Available From",value:s.availableFrom||"",onChange:a,required:!0}),e.jsx(P,{name:"availableUntil",type:"date",label:"Available Until",value:s.availableUntil||"",onChange:a}),e.jsx(P,{name:"attemptsAllowed",type:"number",label:"Attempts Allowed",min:"1",value:s.attemptsAllowed||"",onChange:a,required:!0})]}),ge="_customSelect_17utp_1",W={customSelect:ge};function ue(s){return ee({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M13 7h9v2h-9zM13 15h9v2h-9zM16 11h6v2h-6zM13 12 8 7v4H2v2h6v4z"},child:[]}]})(s)}const he=({questions:s,currentPage:a,totalPages:c,onPageChange:d,onAddQuestion:t,onDeleteQuestion:x,selectedQuestions:g,onSortChange:N,onQuestionScoreChange:S})=>{const[p,_]=h.useState(null),[m,v]=h.useState("asc"),[k,T]=h.useState({});h.useState({});const q=n=>{p===n?v(m==="asc"?"desc":"asc"):(_(n),v("asc")),N(n,m==="asc"?"desc":"asc")},C=n=>p===n?e.jsx($,{className:`ml-1 inline-block ${m==="asc"?"transform rotate-180":""}`}):e.jsx($,{className:"ml-1 inline-block text-gray-300"}),D=n=>{T(w=>({...w,[n]:!w[n]}))};return console.log("questions",g),e.jsxs("div",{children:[e.jsx("div",{className:"relative overflow-x-auto mt-4 rounded-lg",children:e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-900 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer",onClick:()=>q("type"),children:e.jsxs("span",{className:"flex items-center",children:["Type ",C("type")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer",onClick:()=>q("questionText"),children:e.jsxs("span",{className:"flex items-center",children:["Question ",C("questionText")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer text-center",onClick:()=>q("difficulty"),children:e.jsxs("span",{className:"flex items-center justify-center",children:["Difficulty ",C("difficulty")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Score"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(n=>{var w;return e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-950 dark:border-gray-700",children:[e.jsxs("th",{scope:"row",className:"px-3 py-2 font-medium text-gray-900 whitespace-nowrap dark:text-gray-400",children:[e.jsx("span",{className:"hidden sm:inline",children:n.type}),e.jsx("span",{className:"sm:hidden",children:n.type.split("_")[0]})]}),e.jsxs("td",{className:"px-3 py-2",children:[k[n._id]?n.questionText:`${n.questionText.substring(0,50)}...`,e.jsx("button",{onClick:()=>D(n._id),className:"ml-2 text-blue-500 hover:text-blue-700",children:k[n._id]?"close up":e.jsx(ue,{})})]}),e.jsx("td",{className:"px-3 py-2 text-center",children:n.difficulty}),e.jsx("td",{className:"px-3 py-2",children:g.find(j=>j._id===n._id)&&e.jsx("input",{type:"number",className:"border text-center w-[70%] px-2 py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 dark:border-gray-700 transition-colors duration-200",required:!0,min:0,max:100,defaultValue:((w=g.find(j=>j._id===n._id))==null?void 0:w.points)||1,onChange:j=>S(n._id,parseInt(j.target.value)||1)})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("div",{className:"flex justify-center",children:g.find(j=>j._id===n._id)?e.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:()=>x(n._id),children:e.jsx(B,{})}):e.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:()=>t(n._id),children:e.jsx(Y,{})})})})]},n._id)})})]})}),c>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("button",{onClick:()=>d(a-1),disabled:a===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:[e.jsx(z,{className:"mr-2"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Page ",a," of ",c]}),e.jsxs("button",{onClick:()=>d(a+1),disabled:a===c,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:["Next",e.jsx(R,{className:"ml-2"})]})]})]})},pe=({passages:s,currentPage:a,totalPages:c,onPageChange:d,onAddPassage:t,onDeletePassage:x,selectedPassages:g,onSortChange:N,onPassagePointChange:S})=>{const[p,_]=h.useState(null),[m,v]=h.useState(1),k=5,[T,q]=h.useState(null),[C,D]=h.useState("asc"),n=i=>{_(p===i?null:i),v(1)},w=i=>{const y=(m-1)*k,L=y+k;return i.slice(y,L)},j=i=>{T===i?D(C==="asc"?"desc":"asc"):(q(i),D("asc")),N(i,C==="asc"?"desc":"asc")},F=i=>T===i?e.jsx($,{className:`ml-1 inline-block ${C==="asc"?"transform rotate-180":""}`}):e.jsx($,{className:"ml-1 inline-block text-gray-300"});return e.jsxs("div",{children:[e.jsx("div",{className:"relative overflow-x-auto mt-4 rounded-lg",children:e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-900 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer",onClick:()=>j("title"),children:e.jsxs("span",{className:"flex items-center",children:["Title ",F("title")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 cursor-pointer hidden md:table-cell",onClick:()=>j("text"),children:e.jsxs("span",{className:"flex items-center",children:["Text ",F("text")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Questions"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Point"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(i=>e.jsxs(se.Fragment,{children:[e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-950 dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-3 py-2 font-medium text-gray-900 whitespace-nowrap dark:text-gray-400",children:i.title}),e.jsxs("td",{className:"px-3 py-2 hidden md:table-cell",children:[i.text.substring(0,50),"..."]}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx("button",{className:"text-blue-500 hover:text-blue-700 mr-2",onClick:()=>n(i._id),children:e.jsxs("div",{className:"flex items-center ",children:[p===i._id?e.jsx(te,{}):e.jsx(ae,{}),e.jsx("p",{className:"ml-2",children:i.questions.length})]})})}),e.jsx("td",{className:"px-3 py-2",children:g.find(y=>y._id===i._id)&&e.jsx("input",{type:"number",className:"border text-center w-[70%] px-2 py-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 dark:border-gray-700 transition-colors duration-200",required:!0,min:0,max:100,defaultValue:i.questions.length,onChange:y=>S(i._id,parseInt(y.target.value))})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("div",{className:"flex justify-center",children:g.find(y=>y._id===i._id)?e.jsx("button",{className:"text-red-500 hover:text-red-700",onClick:()=>x(i._id),children:e.jsx(B,{})}):e.jsx("button",{className:"text-blue-500 hover:text-blue-700",onClick:()=>t(i._id,i.questions.length),children:e.jsx(Y,{})})})})]}),p===i._id&&e.jsx("tr",{className:"bg-white border-b dark:bg-gray-950 dark:border-gray-700",children:e.jsx("td",{colSpan:"4",className:"px-3 py-2",children:e.jsxs("div",{className:"p-3 w-full",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Questions:"}),e.jsx("ul",{className:"space-y-4 w-full",children:w(i.questions).map(y=>e.jsxs("li",{className:"border-b border-gray-200 dark:border-gray-600 pb-2",children:[e.jsxs("p",{className:"text-sm mb-1",children:[y.questionText.substring(0,100),"..."]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full dark:bg-blue-900 dark:text-blue-300",children:["Type: ",y.type]}),e.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full dark:bg-green-900 dark:text-green-300",children:["Difficulty: ",y.difficulty]})]})]},y._id))}),i.questions.length>k&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("button",{onClick:()=>v(m-1),disabled:m===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:[e.jsx(z,{className:"mr-2"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Page ",m," of"," ",Math.ceil(i.questions.length/k)]}),e.jsxs("button",{onClick:()=>v(m+1),disabled:m===Math.ceil(i.questions.length/k),className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:["Next",e.jsx(R,{className:"ml-2"})]})]})]})})})]},i._id))})]})}),c>1&&e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("button",{onClick:()=>d(a-1),disabled:a===1,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:[e.jsx(z,{className:"mr-2"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Page ",a," of ",c]}),e.jsxs("button",{onClick:()=>d(a+1),disabled:a===c,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:["Next",e.jsx(R,{className:"ml-2"})]})]})]})},ye=({section:s,index:a,onUpdateSection:c,onDeleteSection:d})=>{const t=["reading","listening"].includes(s.name),[x,g]=h.useState(1),[N,S]=h.useState(null),[p,_]=h.useState("asc"),[m,v]=h.useState("me"),k={section:s.name,createdBy:m,page:x,limit:5,sortBy:N,orderBy:p};console.log("section",s);const{data:T,isLoading:q,error:C}=re(k,{skip:!t}),{data:D,isLoading:n}=ne(k,{skip:t}),w=l=>{v(l.target.value),g(1)},j=(l,u)=>{const b={...s,[l]:u};c(b)},F=l=>{g(l)},i=l=>{const u=s.name==="speaking"||s.name==="writing"?1:ie;if(s.questions.length<u&&!s.questions.find(b=>b._id===l)){const b={...s,sectionScore:s.sectionScore+1,questions:[...s.questions,{_id:l,points:1}]};c(b)}else console.log(`you can't add more than ${u} questions to a ${s.name} section`)},y=l=>{const u={...s,questions:s.questions.filter(b=>b._id!==l)};c(u)},L=(l,u)=>{if(!s.passages.find(f=>f._id===l)){const f={...s,sectionScore:s.sectionScore+u,passages:[...s.passages,{_id:l,points:u}]};c(f)}},M=(l,u)=>{const b={...s,sectionScore:s.sectionScore+u-s.passages.find(f=>f._id===l).points,passages:s.passages.map(f=>f._id===l?{...f,points:u}:f)};c(b)},I=(l,u)=>{const b={...s,sectionScore:s.sectionScore+u-s.questions.find(f=>f._id===l).points,questions:s.questions.map(f=>f._id===l?{...f,points:u}:f)};c(b)},O=l=>{const u={...s,sectionScore:s.sectionScore-s.passages.find(b=>b._id===l).points,passages:s.passages.filter(b=>b._id!==l)};c(u)},E=(l,u)=>{S(l),_(u)};return e.jsxs("div",{className:"border p-4 rounded-md border-gray-300 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s.name.charAt(0).toUpperCase()+s.name.slice(1)," Section"]}),C&&e.jsx("p",{children:"There is an error in loading data, please try again later"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("p",{children:["Total Score: ",s.sectionScore]})}),e.jsx("button",{onClick:d,className:"text-red-500 hover:text-red-700",title:"Delete Section",children:e.jsx(B,{})})]}),e.jsx(P,{name:`section-${a}-duration`,label:"Duration (minutes)",type:"number",value:s.duration,onChange:l=>j("duration",parseInt(l.target.value)),required:!0}),e.jsxs("select",{value:m,onChange:w,className:`bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-900 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-300 dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-5 ${W.customSelect}`,children:[e.jsx("option",{value:"me",children:"My Questions"}),e.jsx("option",{value:"all",children:"All Questions"})]}),e.jsx(P,{name:`section-${a}-instructions`,label:"Instructions",type:"textarea",value:s.instructions,onChange:l=>j("instructions",l.target.value),required:!0,className:"mt-5"}),t?q?e.jsx("p",{children:"Loading passages..."}):T&&e.jsx(pe,{passages:T.data.passages,currentPage:x,totalPages:T.data.totalPages,onPageChange:F,onAddQuestion:i,onDeleteQuestion:y,selectedQuestions:s.questions,onAddPassage:(l,u)=>L(l,u),onDeletePassage:O,selectedPassages:s.passages,onSortChange:E,onPassagePointChange:M}):n?e.jsx("p",{children:"Loading questions..."}):D&&e.jsx(he,{questions:D.data.questions,currentPage:x,totalPages:D.data.totalPages,onPageChange:F,onAddQuestion:(l,u)=>i(l),onDeleteQuestion:y,selectedQuestions:s.questions,onSortChange:E,onQuestionScoreChange:I})]})},be=({sections:s,onAddSection:a,onUpdateSection:c,onDeleteSection:d})=>{const[t,x]=h.useState(""),[g,N]=h.useState(0),[S,p]=h.useState(""),_=()=>{t&&["reading","listening"].includes(t)?(a({name:t,passages:[],duration:g,instructions:S,sectionScore:0}),x(""),N(0),p("")):t&&(a({name:t,questions:[],duration:g,instructions:S,sectionScore:0}),x(""),N(0),p(""))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Test Sections"}),e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:space-y-0 sm:space-x-4 justify-center items-center",children:[e.jsx("div",{className:"w-full sm:w-1/4",children:e.jsxs("select",{value:t,onChange:m=>x(m.target.value),className:`bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-3 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 ${W.customSelect}`,children:[e.jsx("option",{value:"",children:"Choose a section"}),me.map(m=>e.jsx("option",{value:m.name,children:m.label},m.name))]})}),e.jsx("div",{className:"w-full sm:w-1/5",children:e.jsx(P,{name:"newSectionDuration",label:"Duration (minutes)",type:"number",value:g,onChange:m=>N(parseInt(m.target.value)),required:!0})}),e.jsx("div",{className:"w-full sm:w-1/3",children:e.jsx(P,{name:"newSectionInstructions",label:"Instructions",type:"textarea",value:S,onChange:m=>p(m.target.value),required:!0,className:"w-full"})}),e.jsx("div",{className:"w-full sm:w-auto sm:self-end",children:e.jsx("button",{onClick:_,className:"w-full sm:w-auto bg-blue-500 text-white px-4 py-3 rounded hover:bg-blue-600 whitespace-nowrap",children:"Add Section"})})]}),s.map((m,v)=>e.jsx(ye,{section:m,index:v,onUpdateSection:k=>c(v,k),onDeleteSection:()=>d(v)},v))]})},fe=({testInfo:s,sections:a})=>{const c=d=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Duration:"})," ",d.duration," ","minutes"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Instructions:"})," ",d.instructions]}),d.passages&&e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["Passages: ",d.passages.length]}),e.jsx("ul",{className:"list-disc pl-5 mt-1",children:d.passages.map((t,x)=>e.jsxs("li",{children:["Passage ",x+1,": ",t.points," points"]},x))}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Total Passage Points:"})," ",d.passages.reduce((t,x)=>t+x.points,0)]})]}),d.questions&&e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:["Questions: ",d.questions.length]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Total Question Points:"})," ",d.questions.reduce((t,x)=>t+x.points,0)]})]})]});return e.jsxs("div",{className:"space-y-6 dark:text-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Test Preview"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:"Test Information"})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:e.jsxs("dl",{children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Title"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.title})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Description"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.description})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Difficulty"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.difficulty})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Duration"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:[s.duration," minutes"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Available From"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.availableFrom})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Available To"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.availableTo})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Attempts Allowed"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.attemptsAllowed})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Passing Score"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.passingScore})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-300",children:"Total Possible Score"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 dark:text-gray-200 sm:mt-0 sm:col-span-2",children:s.totalPossibleScore})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg mt-6",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:"Test Sections"})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:a.map((d,t)=>e.jsxs("div",{className:`${t%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"} px-4 py-5 sm:px-6 flex gap-6 sm:grid sm:grid-cols-3 sm:gap-4`,children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:d.name.charAt(0).toUpperCase()+d.name.slice(1)}),c(d)]},t))})]})]})},H={title:"",description:"",duration:0,difficulty:J[0].name,testType:K[0].name,passingScore:0,totalPossibleScore:0,availableFrom:new Date().toISOString().split("T")[0],availableUntil:new Date(new Date().setFullYear(new Date().getFullYear()+1)).toISOString().split("T")[0],attemptsAllowed:1},V=[],ke=({mode:s})=>{console.log("mode",s);const{id:a}=le(),[c,d]=h.useState(1),[t,x]=h.useState(H),[g,N]=h.useState(V),[S,p]=h.useState({}),[_,{isLoading:m,isSuccess:v,error:k}]=de(),[T,{isLoading:q,isSuccess:C,error:D}]=oe(),{data:n,isLoading:w,error:j}=ce(a,{skip:!a});h.useEffect(()=>{var r;n&&(x({...n.data,availableFrom:new Date(n.data.availableFrom).toISOString().split("T")[0],availableUntil:new Date(n.data.availableUntil).toISOString().split("T")[0]}),N((r=n.data)==null?void 0:r.sections))},[n]);const F=r=>{const{name:o,value:Q,type:A}=r.target;x(X=>({...X,[o]:A==="number"?parseFloat(Q)||0:Q}))},i=r=>{x(o=>({...o,difficulty:r.target.value}))},y=r=>{x(o=>({...o,testType:r.target.value}))},L=r=>{N(o=>[...o,r])},M=(r,o)=>{N(Q=>{const A=[...Q];return A[r]=o,A})},I=()=>{let r=0;for(const o of g)r+=o.sectionScore;return r};h.useEffect(()=>{x(r=>({...r,totalPossibleScore:I()}))},[g]);const O=()=>{const r={};return t.title.trim()||(r.title="Title is required"),t.description.trim()||(r.description="Description is required"),t.difficulty||(r.difficulty="Difficulty is required"),t.availableFrom||(r.availableFrom="Available From date is required"),t.availableUntil||(r.availableUntil="Available Until date is required"),t.attemptsAllowed||(r.attemptsAllowed="Attempts Allowed is required"),t.passingScore<=0&&(r.passingScore="Passing Score must be greater than 0"),p(r),Object.keys(r).length===0},E=()=>{if(g.length===0)return p({sections:"At least one section is required"}),!1;let r=0;for(const o of g){const Q=[{condition:!o.name,message:"Section name is required"},{condition:!o.duration||o.duration<=0,message:"Section duration must be greater than 0"},{condition:!o.instructions,message:"Section instructions are required"},{condition:(o.name==="reading"||o.name==="listening")&&(!o.passages||o.passages.length===0),message:`Add at least one passage for ${o.name} section`},{condition:o.name!=="reading"&&o.name!=="listening"&&(!o.questions||o.questions.length===0),message:`Add at least one question for ${o.name} section`}];for(const A of Q)if(A.condition)return p({sections:A.message}),!1;r+=o.duration}return x(o=>({...o,duration:r})),p({}),!0},l=()=>{c===1&&O()?d(2):c===2&&E()&&d(3)},u=async()=>{if(t.passingScore>t.totalPossibleScore){p({passingScore:"Passing score cannot exceed total possible score"});return}if(O()&&E()){const r={...t,sections:g};try{a?(await T({id:a,...r}),console.log("finalTestData",r),U.success("Test updated successfully!")):(console.log("finalTestData",r),U.success("Test created successfully!")),a||(x(H),N(V),await _(r),d(1))}catch(o){U.error(o.message||"An error occurred")}}},b=r=>{N(o=>o.filter((Q,A)=>A!==r))},f=()=>{switch(c){case 1:return e.jsx(xe,{testInfo:t,handleBasicInfoChange:F,handleDifficultyChange:i,handleTestTypeChange:y});case 2:return e.jsx(be,{sections:g,onAddSection:L,onUpdateSection:M,onDeleteSection:b});case 3:return e.jsx(fe,{testInfo:t,sections:g});default:return null}};return a&&w?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"loader"})}):a&&j?e.jsxs("div",{className:"text-red-500 text-center",children:["Error loading test: ",j.message]}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 dark:text-white",children:a?"Edit Test":"Create New Test"}),f(),Object.keys(S).length>0&&e.jsx("div",{className:"text-red-500 mt-4",children:Object.values(S).length>0&&e.jsx("p",{children:Object.values(S)[0]})}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[c>1&&e.jsx("button",{onClick:()=>d(c-1),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition-colors duration-200",children:"Previous"}),c<3?e.jsx("button",{onClick:l,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors duration-200",children:"Next"}):e.jsx("button",{onClick:u,className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors duration-200",disabled:m,children:m?e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"Finalizing..."}),e.jsx("div",{className:"loader"})]}):"Finalize Test"})]})]})};export{ke as default};
