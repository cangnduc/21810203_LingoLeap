import{c as B,j as e,d as M,e as z,B as u,f as U,g as F,h as q,r as T,X as G,u as H,i as Q,k as X,t as Y,l as I}from"./index-DVmOQZrp.js";import{f as J}from"./format-C9os4azF.js";import{S as w}from"./Select-BDEop4ZP.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=B("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=B("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=B("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),L=({onClick:t,isLoading:a})=>e.jsx("div",{className:"flex items-center justify-center text-red-500 hover:text-red-600 border border-red-500 hover:border-red-600 rounded-md p-1",children:e.jsxs("button",{className:"flex items-center gap-0.5",onClick:t,disabled:a,children:[e.jsx(Z,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:block text-xs px-1",children:"Delete"})]})}),O=({onClick:t})=>e.jsx("div",{className:"flex items-center justify-center text-blue-500 hover:text-blue-600 border border-blue-500 hover:border-blue-600 rounded-md p-1",children:e.jsxs("button",{className:"flex items-center gap-0.5",onClick:t,children:[e.jsx(K,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:block text-xs px-1",children:"View"})]})}),$=({id:t})=>{const a=M(),[n,{isLoading:x,error:l}]=z(),p=async()=>{var g;const d=await n({testId:t});d.data?(a(`/test-attempt/${d.data._id}`),d.data.test!==t&&u.error("You can only attempt a test once at a time")):u.error((g=d.error)==null?void 0:g.errors)};return e.jsx("div",{className:"flex items-center justify-center text-green-500 hover:text-green-600 border border-green-500 hover:border-green-600 rounded-md p-1",children:e.jsxs("button",{className:"flex items-center gap-0.5",onClick:p,children:[e.jsx(W,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:block text-xs px-1",children:"Attempt"})]})})},ee=({checked:t,onChange:a,disabled:n,label:x})=>e.jsxs("button",{onClick:a,disabled:n,className:"flex items-center gap-2 focus:outline-none",children:[e.jsx("div",{className:`relative w-11 h-6 rounded-full transition-colors duration-300 ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"} ${t?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 rounded-full bg-white transition-transform duration-300 ${t?"translate-x-5":"translate-x-0"}`})}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:n?"Updating...":t?"Published":"Draft"})]}),D=({test:t,userId:a})=>{const n=M(),[x,{isLoading:l}]=U(),[p,{isLoading:d}]=F(),{title:g,description:m,testType:N,duration:r,totalPossibleScore:k,passingScore:v,sections:C,createdBy:y,_id:c,availableFrom:b,availableUntil:j,totalAttempts:s,attemptsAllowed:o,averageRating:h,difficulty:P,isPublished:S,participantCount:_}=t,V=async()=>{var i;try{await x(c).unwrap(),u.success("Test published successfully")}catch(f){u.error(((i=f==null?void 0:f.data)==null?void 0:i.message)||"Failed to publish test")}},E=async()=>{var i;try{await p(c).unwrap(),u.success("Test deleted successfully")}catch(f){u.error(((i=f==null?void 0:f.data)==null?void 0:i.message)||"Failed to delete test")}},R=()=>{n(`/tests/${c}`)},A=i=>J(new Date(i),"MMM dd, yyyy");return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow border border-gray-200 dark:border-gray-700 h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white truncate pr-2",children:g}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:h&&h.toFixed(1)}),e.jsx(q,{className:"text-yellow-400"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300 rounded-full text-xs",children:P}),S&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 rounded-full text-xs",children:"Published"})]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:(m==null?void 0:m.length)>100?`${m.substring(0,100)}...`:m}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Duration:"}),e.jsxs("p",{className:"font-medium dark:text-white",children:[r," minutes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Passing Score Required:"}),e.jsxs("p",{className:"font-medium dark:text-white",children:[v,"/",k]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Attempts:"}),e.jsxs("p",{className:"font-medium dark:text-white",children:[s,"/",o||"âˆž"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Type:"}),e.jsx("p",{className:"font-medium dark:text-white",children:N})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sections:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:C.map(i=>e.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-xs text-gray-700 dark:text-gray-300",children:[i.name," (",i.sectionScore," pts)"]},i._id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Available:"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["From: ",A(b)]}),e.jsxs("span",{children:["To: ",A(j)]})]})]}),e.jsxs("div",{className:"mb-4 flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created by:"}),e.jsx("span",{className:"text-sm font-medium dark:text-white",children:y.username})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Participants:"}),e.jsx("span",{className:"text-sm font-medium dark:text-white",children:_||0})]})]}),e.jsx("div",{className:"flex-grow"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mt-auto pt-4 border-t border-gray-200 dark:border-gray-700",children:[a===y._id&&e.jsx(ee,{checked:S,onChange:V,disabled:l}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[a===y._id&&e.jsx(L,{onClick:E,isLoading:d}),e.jsx(O,{onClick:R}),e.jsx($,{id:c})]})]})]})},se=({test:t,userId:a,index:n})=>{const[x,l]=T.useState(!1),p=T.useRef(null),d=M(),[g,{isLoading:m}]=F(),{title:N,description:r,testType:k,isPublished:v,totalAttempts:C,createdBy:y,_id:c}=t,b=async()=>{var o;try{await g(c).unwrap(),u.success("Test deleted successfully")}catch(h){u.error(((o=h==null?void 0:h.data)==null?void 0:o.message)||"Failed to delete test")}},j=()=>{d(`/tests/${c}`)},s=()=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 hover:shadow-md transition-shadow border border-gray-200 dark:border-gray-700 h-full flex flex-col",onClick:()=>l(!0),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white truncate pr-2",children:N}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs flex-shrink-0 ${v?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"}`,children:v?"Published":"Private"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:(r==null?void 0:r.length)>40?`${r.substring(0,40)}...`:r}),e.jsx("div",{className:"flex-grow"}),e.jsxs("div",{className:"flex justify-between items-center mt-auto",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 rounded-full text-xs",children:k}),e.jsxs("div",{className:"flex items-center gap-1",children:[a===y._id&&e.jsx(L,{onClick:b,isLoading:m}),e.jsx(O,{onClick:j}),e.jsx($,{id:c})]})]})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden h-full",children:e.jsx(s,{})}),e.jsx("div",{className:"hidden md:block h-full",children:e.jsx(D,{test:t,userId:a})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 md:hidden",children:e.jsxs("div",{ref:p,className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-lg max-h-[90vh] overflow-y-auto relative",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-800 py-1 px-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:["STT: ",n+1]}),e.jsx("button",{onClick:o=>{o.stopPropagation(),l(!1)},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(G,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-2",children:e.jsx(D,{test:t,userId:a})})]})})]})},te=()=>{const[t,a]=T.useState(1),[n]=T.useState(10),x=H(s=>s.auth.user),[l,p]=T.useState({difficulty:"",testType:"",orderBy:"createdAt",sortBy:"desc",createdBy:""}),{data:d,isLoading:g,isError:m,error:N}=Q({page:t,limit:n,...l});console.log("data",d);const r=s=>{const{name:o,value:h}=s.target;p(P=>({...P,[o]:h})),a(1)},k=[{value:"",label:"All Difficulties"},...X.map(s=>({value:s.value,label:s.label,color:s.color}))],v=[{value:"",label:"All Types"},...I.map(s=>({value:s,label:s}))],C=Y.map(s=>({value:s.value,label:`Order by ${s.label}`})),y=[{value:"desc",label:"Descending"},{value:"asc",label:"Ascending"}],c=[{value:"",label:"All Tests"},{value:"me",label:"My Tests"}];if(g)return e.jsx("div",{children:"Loading..."});if(m)return e.jsx("div",{children:N.message});if(!d)return e.jsx("div",{children:"No data available"});const{tests:b,totalPages:j}=d;return e.jsxs("div",{className:"p-4 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsx(w,{label:"Difficulty",name:"difficulty",value:l.difficulty,onChange:r,options:k}),e.jsx(w,{label:"Test Type",name:"testType",value:l.testType,onChange:r,options:v}),e.jsx(w,{label:"Order By",name:"orderBy",value:l.orderBy,onChange:r,options:C}),e.jsx(w,{label:"Sort Order",name:"sortBy",value:l.sortBy,onChange:r,options:y}),e.jsx(w,{label:"Created By",name:"createdBy",value:l.createdBy,onChange:r,options:c})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 auto-rows-fr",children:b==null?void 0:b.data.map((s,o)=>e.jsx(se,{userId:x==null?void 0:x._id,index:o,test:s},s._id))}),e.jsxs("div",{className:"mt-8 flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>a(s=>Math.max(s-1,1)),disabled:t===1,className:"px-4 py-2 border rounded-md disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-800 rounded-md",children:["Page ",t," of ",j]}),e.jsx("button",{onClick:()=>a(s=>Math.min(s+1,j)),disabled:t===j,className:"px-4 py-2 border rounded-md disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Next"})]})]})},de=()=>e.jsx(e.Fragment,{children:e.jsx(te,{})});export{de as default};
